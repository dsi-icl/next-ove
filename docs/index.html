<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>next-ove Documentation</title>
  <style>

      /* Box sizing rules */
      *,
      *::before,
      *::after {
          box-sizing: border-box;
          font-family: "Imperial Sans Display", sans-serif;
      }

      /* Prevent font size inflation */
      html {
          -moz-text-size-adjust: none;
          -webkit-text-size-adjust: none;
          text-size-adjust: none;
      }

      /* Remove default margin in favour of better control in authored CSS */
      body, h1, h2, h3, h4, p,
      figure, blockquote, dl, dd {
          margin-block-end: 0;
      }

      /* Remove list styles on ul, ol elements with a list role, which suggests default styling will be removed */
      ul[role='list'],
      ol[role='list'] {
          list-style: none;
      }

      /* Set core body defaults */
      body {
          min-height: 100vh;
          line-height: 1.5;
          background-color: #002147;
          color: white;
          padding: 2rem;
      }

      /* Set shorter line heights on headings and interactive elements */
      h1, h2, h3, h4,
      button, input, label {
          line-height: 1.1;
      }

      /* Balance text wrapping on headings */
      h1, h2,
      h3, h4 {
          text-wrap: balance;
      }

      /* A elements that don't have a class get default styles */
      a:not([class]) {
          text-decoration-skip-ink: auto;
          color: currentColor;
      }

      /* Make images easier to work with */
      img,
      picture {
          max-width: 100%;
          display: block;
      }

      /* Inherit fonts for inputs and buttons */
      input, button,
      textarea, select {
          font-family: inherit;
          font-size: inherit;
      }

      /* Make sure textareas without a rows attribute are not tiny */
      textarea:not([rows]) {
          min-height: 10em;
      }

      /* Anything that has been anchored to should have extra scroll margin */
      :target {
          scroll-margin-block: 5ex;
      }

      section {
          padding-top: 2rem;
      }
  </style>
</head>
<body>
<h1 style="text-align: center;">next-ove Documentation</h1>
<section id="api">
  <h2>API</h2>
  <ul role="list" id="api-list"></ul>
</section>
<section id="code">
  <h2>Code</h2>
  <ul>
    <li><a href="/code">Documentation</a></li>
  </ul>
</section>
<section id="specs">
  <h2>Specifications</h2>
  <ul id="spec-list"></ul>
</section>
<section id="tests">
  <h2>Tests</h2>
  <h3>Coverage</h3>
  <ul role="list" id="coverage-list"></ul>
</section>
<section id="types">
  <h2>Types</h2>
  <ul>
    <li><a href="/types">Documentation</a></li>
  </ul>
</section>
<script>
  let apis = null;
  let specs = null;
  let coverage = null;

  const buildDetails = (listId, arr) => {
    const ul = document.getElementById(listId);
    arr.forEach(({ header, files }) => {
      const li = document.createElement('li');
      li.role = 'list';
      const details = document.createElement('details');
      const summary = document.createElement('summary');
      summary.textContent = header;
      details.appendChild(summary);
      const childList = document.createElement('ul');
      details.appendChild(childList);
      li.appendChild(details);
      ul.appendChild(li);

      childList.id = header;
      buildLinks(header, files);
    });
  };

  const buildLinks = (listId, arr) => {
    const ul = document.getElementById(listId);
    arr.forEach(({ href, label }) => {
      const li = document.createElement('li');
      const a = document.createElement('a');

      a.href = href;
      a.textContent = label;

      li.appendChild(a);
      ul.appendChild(li);
    });
  };

  window.onload = async () => {
    apis = await (await fetch('/api/apis')).json();
    specs = await (await fetch('/api/specs')).json();
    coverage = await (await fetch('/api/coverage')).json();
    buildDetails('api-list', apis);
    buildLinks('spec-list', specs);
    buildDetails('coverage-list', coverage);
  };
</script>
</body>
</html>